<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Amazement</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-icons">
            <a href="videos.html" class="icon-link" aria-label="All Videos" title="View All Videos">
                <i class="fas fa-video"></i>
            </a>
            <a href="https://instagram.com/daily_amazement_" target="_blank" class="icon-link" aria-label="Instagram">
                <i class="fab fa-instagram"></i>
            </a>
            <a href="https://www.youtube.com/@dailyamazment" target="_blank" class="icon-link" aria-label="YouTube">
                <i class="fab fa-youtube"></i>
            </a>
        </div>
        <div class="logo-img">
            <img src="logo.png" alt="Daily Amazement Logo">
        </div>
        <div class="description-text">
            Welcome to Daily Amazement â€” the channel that brings you the most amazing videos, viral moments, and unbelievable facts from around the world. Our goal is to entertain, surprise, and inspire curiosity with every upload. From incredible discoveries and mind blowing science to strange events and real life wonders, you'll find videos that make you stop and say, "Is that even possible?" The answer is yes, and we show you every detail. If you love fun facts, viral clips, amazing stories, and content that keeps you asking questions, hit subscribe and get ready to be amazed every day.
            <br><br>
            <a href="https://www.youtube.com/@dailyamazment" target="_blank" class="subscribe-button">
                <i class="fab fa-youtube"></i>
                Subscribe
            </a>
        </div>
    </header>

    <main>
        <section class="form-section">
            <h2>Youtube Subscribers Win Big</h2>
            <p class="description-text">Want to win our monthly prize? Subscribe to our Youtube channel and fill out the below to be in with a shot!</p>
            <form class="subscriber-form">
                <div class="form-group">
                    <input type="text" id="firstName" name="firstName" placeholder="First Name" required>
                </div>
                <div class="form-group">
                    <input type="text" id="lastName" name="lastName" placeholder="Last Name" required>
                </div>
                <div class="form-group">
                    <input type="text" id="youtubeName" name="youtubeName" placeholder="YouTube Username" required>
                </div>
                <div class="form-group">
                    <input type="text" id="codeword" name="codeword" placeholder="Codeword from Youtube video" required>
                </div>
                <div class="form-group">
                    <input type="email" id="email" name="email" placeholder="Email Address" required>
                </div>
                <button type="submit" class="enter-button">Enter</button>
            </form>
            
            <!-- Success Message -->
            <div id="success-message" style="display: none; background: rgba(0, 255, 0, 0.1); border: 1px solid rgba(0, 255, 0, 0.3); border-radius: 10px; padding: 2rem; margin-top: 2rem; text-align: center;">
                <i class="fas fa-check-circle" style="color: #90EE90; font-size: 3rem; margin-bottom: 1rem;"></i>
                <h3 style="color: #90EE90; margin-bottom: 1rem;">Thanks for your entry!</h3>
                <p style="color: #fff; margin-bottom: 1rem; line-height: 1.6;">
                    We'll contact the winner directly. Don't forget, you can enter each codeword you come across so keep watching Daily Amazement for another chance to win!
                </p>
                <div style="margin-top: 1.5rem;">
                    <a href="https://www.youtube.com/@dailyamazment" target="_blank" class="subscribe-button" style="text-decoration: none; display: inline-block; margin-right: 1rem;">
                        <i class="fab fa-youtube"></i>
                        Continue Watching Daily Amazement
                    </a>
                    <button onclick="hideSuccessMessage()" style="background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255, 255, 255, 0.3); padding: 10px 20px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease;">
                        Enter Another Codeword
                    </button>
                </div>
            </div>
        </section>

        <section class="prize-section">
            <h2>This Month's Prize...</h2>
            <div class="prize-image">
                <img src="https://static.nike.com/a/images/f_auto/dpr_2.0,cs_srgb/h_1029,c_limit/97e43798-a15e-4c10-8ed0-df5ad5899430/jordan-brand-launches-the-air-jordan-xxxviii.jpg" alt="Air Jordan XXXVIII">
            </div>
            <p class="prize-description">
                Inspired by the straps on the Air Jordan VIII, the Air Jordan XXXVIII sneaker will debut the X-Plate, a new plate technology that helps to keep players' feet secure over the footbed during sharp movements.<br>
                The upper features embroidered designs highlighting Michael Jordan's performance in the 1993 championship series.<br>
                The Air Jordan XXXVIII is the most sustainably made Air Jordan signature shoe in Jordan Brand history, made from at least 20 percent recycled material by weight.
            </p>
            <div class="winner-section">
                <h2>Most Recent Winner</h2>
                <div id="winner-name">John Doe<br>Youtube name: @ScoobyBoi78</div>
            </div>
        </section>

        <section class="videos-section">
            <h2>Featured Videos</h2>
            <div id="video-container">
                <!-- YouTube videos will be added here -->
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <a href="videos.html" class="subscribe-button" style="text-decoration: none; display: inline-block;">
                    <i class="fas fa-video"></i>
                    See More Videos
                </a>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Daily Amazement. All rights reserved.<br>
            <a href="https://instagram.com/daily_amazement_" target="_blank" style="color:#FFD700;text-decoration:none;font-weight:600;">
                <i class="fab fa-instagram"></i> @daily_amazement_
            </a>
        </p>
    </footer>

    <!-- Admin Access Padlock -->
    <a href="admin-login.html" class="admin-padlock" title="Admin Access">
        <i class="fas fa-lock"></i>
    </a>

    <style>
        .admin-padlock {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255, 215, 0, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: #111;
            font-size: 20px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .admin-padlock:hover {
            background: rgba(255, 215, 0, 1);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
        }

        .admin-padlock:active {
            transform: scale(0.95);
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="script.js"></script>
    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://gstyydgnyenjzeeeqrse.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzdHl5ZGdueWVuanplZWVxcnNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3NDUzOTAsImV4cCI6MjA2OTMyMTM5MH0.41mI_Fn-S6bptZjK20PjXIMeKy62ScHJftUT3ahdJQ4';
        
        let supabaseClient;
        try {
            supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
            console.log('Supabase client initialized successfully');
        } catch (error) {
            console.error('Failed to initialize Supabase client:', error);
            alert('Failed to initialize database connection. Please refresh the page and try again.');
        }

        // Handle form submission
        document.querySelector('.subscriber-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            console.log('ðŸš€ Form submitted!');
            
            // Disable submit button to prevent double submission
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;
            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';
            
            try {
                // Get form values
                const firstName = document.getElementById('firstName').value.trim();
                const lastName = document.getElementById('lastName').value.trim();
                const youtubeName = document.getElementById('youtubeName').value.trim();
                const codeword = document.getElementById('codeword').value.trim();
                const email = document.getElementById('email').value.trim();
                
                console.log('ðŸ“ Form values collected:', { firstName, lastName, youtubeName, codeword, email });
                
                // Basic validation
                if (!firstName || !lastName || !youtubeName || !codeword || !email) {
                    alert('Please fill in all required fields.');
                    return;
                }
                
                // Email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    alert('Please enter a valid email address.');
                    return;
                }
                
                const formData = {
                    firstname: firstName,
                    lastname: lastName,
                    youtubename: youtubeName,
                    codeword: codeword,
                    email: email,
                    submittedat: new Date().toISOString()
                };

                console.log('ðŸ“Š Form data prepared:', formData);
                console.log('ðŸ”Œ Supabase client status:', supabaseClient ? 'Available' : 'Not available');

                // Check if Supabase client is available
                if (!supabaseClient) {
                    alert('Database connection not available. Please refresh the page and try again.');
                    return;
                }

                console.log('ðŸš€ Attempting to insert entry into database...');
                
                // Insert new entry
                const { data, error } = await supabaseClient
                    .from('competition_entries')
                    .insert([formData]);

                if (error) {
                    console.error('âŒ Error saving entry:', error);
                    console.error('ðŸ“‹ Error details:', JSON.stringify(error, null, 2));
                    
                    // More specific error messages
                    if (error.code === '23505') {
                        alert('You have already submitted an entry with this email and codeword combination. Please use a different codeword or email.');
                    } else if (error.message) {
                        alert(`Database Error: ${error.message}`);
                    } else {
                        alert('Error submitting entry. Please try again.');
                    }
                    return;
                }

                console.log('âœ… Entry saved successfully!', data);
                // Show success message
                showSuccessMessage();
                document.querySelector('.subscriber-form').reset();

            } catch (error) {
                console.error('ðŸ’¥ Unexpected error:', error);
                console.error('ðŸ” Error stack:', error.stack);
                alert(`An unexpected error occurred: ${error.message}. Please try again or contact support.`);
            } finally {
                // Re-enable submit button
                submitButton.disabled = false;
                submitButton.textContent = originalText;
            }
        });

        // Test function to manually show success message
        function testSuccessMessage() {
            console.log('Testing success message...');
            showSuccessMessage();
        }

        // Add a test button to the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded - form ready to submit entries!');
            
            // Load admin-updated content
            loadAdminContent();
            
            // Test Supabase connection
            testSupabaseConnection();
        });
        
        // Test Supabase connection
        async function testSupabaseConnection() {
            try {
                console.log('ðŸ”„ Testing Supabase connection...');
                console.log('ðŸ“¡ Supabase URL:', supabaseUrl);
                console.log('ðŸ”‘ Supabase Key (first 20 chars):', supabaseKey.substring(0, 20) + '...');
                
                const { data, error } = await supabaseClient
                    .from('competition_entries')
                    .select('count')
                    .limit(1);
                
                if (error) {
                    console.error('âŒ Supabase connection test failed:', error);
                    console.error('ðŸ“‹ Connection error details:', JSON.stringify(error, null, 2));
                } else {
                    console.log('âœ… Supabase connection successful!');
                    console.log('ðŸ“Š Test query result:', data);
                }
            } catch (error) {
                console.error('ðŸ’¥ Supabase connection test error:', error);
                console.error('ðŸ” Connection error stack:', error.stack);
            }
        }

        // Function to show success message
        function showSuccessMessage() {
            console.log('showSuccessMessage called');
            const successElement = document.getElementById('success-message');
            console.log('Success element:', successElement);
            successElement.style.display = 'block';
            console.log('Success message should now be visible');
            // Scroll to the success message
            successElement.scrollIntoView({ behavior: 'smooth' });
        }

        // Function to hide success message
        function hideSuccessMessage() {
            console.log('hideSuccessMessage called');
            document.getElementById('success-message').style.display = 'none';
        }

        // Function to load admin-updated content from database
        async function loadAdminContent() {
            console.log('ðŸ”„ Loading admin-updated content from database...');
            
            try {
                const { data, error } = await supabaseClient
                    .from('site_config')
                    .select('*');
                
                if (error) {
                    console.error('Error loading site config:', error);
                    return;
                }
                
                const config = {};
                data.forEach(row => {
                    config[row.config_key] = row.config_value;
                });
                
                // Load prize image
                if (config.prize_image_url) {
                    const prizeImg = document.querySelector('.prize-image img');
                    if (prizeImg) {
                        prizeImg.src = config.prize_image_url;
                        if (config.prize_image_alt) {
                            prizeImg.alt = config.prize_image_alt;
                        }
                        console.log('âœ… Prize image updated from database');
                    }
                }
                
                // Load prize description
                if (config.prize_description) {
                    const descElement = document.querySelector('.prize-description');
                    if (descElement) {
                        descElement.innerHTML = config.prize_description;
                        console.log('âœ… Prize description updated from database');
                    }
                }
                
                // Load winner information
                if (config.winner_name && config.winner_youtube) {
                    const winnerElement = document.getElementById('winner-name');
                    if (winnerElement) {
                        winnerElement.innerHTML = `${config.winner_name}<br>Youtube name: ${config.winner_youtube}`;
                        console.log('âœ… Winner information updated from database');
                    }
                }
                
                // Load featured videos
                if (config.featured_videos) {
                    try {
                        const videoIds = JSON.parse(config.featured_videos);
                        if (videoIds && videoIds.length >= 3) {
                            // Clear existing videos and add admin-selected ones
                            const videoContainer = document.getElementById('video-container');
                            if (videoContainer) {
                                videoContainer.innerHTML = '';
                                // Use first 3 videos for main site
                                videoIds.slice(0, 3).forEach(videoId => {
                                    if (typeof addVideo === 'function') {
                                        addVideo(videoId);
                                    }
                                });
                                console.log('âœ… Featured videos updated from database');
                            }
                        }
                    } catch (error) {
                        console.error('Error parsing featured videos:', error);
                    }
                }
                
            } catch (error) {
                console.error('Error loading admin content:', error);
            }
        }
    </script>
</body>
</html> 